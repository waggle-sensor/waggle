## Uglybox and Uglykit 

The Uglybox and Uglykit are easily accessible and tinkerer friendly implementations of the [Waggle Platform](http://wa8.gl/?page_id=154). The Uglybox is a field deployable form of the Uglykit. Keeping with the extensible and modular architecture of the Waggle Platform, the Uglyboxes or kits can come in various sensor configurations, but are often built with the [Metsense](https://github.com/waggle-sensor/sensors/tree/master#metsense-hw-ver-31), [Lightsense](https://github.com/waggle-sensor/sensors/tree/master#lightsense-hw-ver-31), [Chemsense boards](https://github.com/waggle-sensor/sensors/tree/master#chemsense-hw-ver-passamaquoddy-bay), two cameras - one [pointing up](http://www.elpcctv.com/8mp-highdefinition-usb-camera-module-usb20-sony-imx179-color-cmos-sensor-75degree-lens-p-223.html) and other [sideways](http://www.elpcctv.com/5megapixel-usb-camera-module-usb20-omnivision-ov5640-color-cmos-sensor-21mm-lens-p-215.html). Other sensors often added to these devices include _Particle Sensors (PM2.5 and PM10), Rain Gauges, Soil Moisture sensors and Microphones_.

## Data Flow

Like all Waggle systems, the ugly devices make a connection to the Beehive Server (beehive1.mcs.anl.gov) located at Argonne. The connections enable the devices to send sensor data to the [central data repository](http://www.mcs.anl.gov/research/projects/waggle/downloads/beehive1/), receive timely software and firmware updates, and also allow remote debugging of the devices. Every node has a Name and ID assigned to it, and the standard set of sensor data generated by the nodes are available for download from the [central data repository](http://www.mcs.anl.gov/research/projects/waggle/downloads/beehive1/). The [Node Controller](http://www.hardkernel.com/main/products/prdt_info.php?g_code=G143703355573)(NC) makes the required connections to the Beehive Server. The [Edge Processor](http://www.hardkernel.com/main/products/prdt_info.php?g_code=G143452239825)(EP) provides the in-situ "edge-computing" horsepower in the current implementation of waggle nodes. The edge-processor does not have direct outbound access to the internet, and communicates only to the Node Controller. 

## Network Connectivity

Waggle nodes (Uglyboxes and kits) do not expose any local network connectivity options. However, they make outbound connections to 
three different ports on `beehive1.mcs.anl.gov (140.221.47.66)`- 
  - Data communication:  Port 23181, SSL encrypted RabbitMQ
  - Management Console: Port 20022, SSH connection
  - Web: Port 80, HTTP
  
  If a node connected to the network is not shown as online within 10 min at [live-nodes link](http://www.mcs.anl.gov/research/projects/waggle/downloads/beehive1/live-nodes.txt), please check the local network firewall rules and make sure the above outgoing 
  ports are not blocked. 
  
## Simple Data Access

The sensor data generated and transmitted by the Ugly Nodes can be obtained from the [central data repository](http://www.mcs.anl.gov/research/projects/waggle/downloads/beehive1/). A simple set of handy scripts to download, convert and plot the data are provided at 
the this link - [simple plots documentation](https://github.com/waggle-sensor/sensors/tree/develop/v3/reports#documentation). 

## Local Node Access Using Console

Waggle platform incorporates security as a core design feature. The node is hence locked down to reduce the surface area for cyber attacks. 
The nodes do not host any network-based services (SSH, HTTP or others) that other devices can connect to, and only make outbound 
connections to specific IP address themselves. However, in order to allow local interaction with the node for debugging and development, 
the physical Serial-console port is made available for developer use. This port both on the Node Controller and Edge Processor can be 
accessed using [UART Console](http://www.hardkernel.com/main/products/prdt_info.php?g_code=G134111883934). This devices uses [USB-UART](https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers) bridge from Silicon Labs. 

The Serial-console is password protected and in nodes which are set to *developer mode*, the user accounts *waggle* and *root*, accept *waggle* as the password. 

In Linux/Mac OS X Systems, we recommend the [GNU Screen](https://www.gnu.org/software/screen/) program for connecting to the serial console. Here are the steps for connecting to the console: 

  - Connect the UART part of the console to the NC in the [Serial console port](http://dn.odroid.com/homebackup/201412042046401584.jpg).
  
  - Connect the UART Console to the user machine, and identify the port using the Termninal program of your choice. The device comes up as a `ttyUSBx` port on Linux systems and  similar tty port under `/dev` in OS X. `dmesg` and `ls -ltr /dev/` are useful commands to identify the device. Below is an example - 
  ```
$dmesg
...
147867-[71756.358783] usb 2-3: New USB device found, idVendor=10c4, idProduct=ea60
147943-[71756.358788] usb 2-3: New USB device strings: Mfr=1, Product=2, SerialNumber=3
148024-[71756.358791] usb 2-3: Product: CP2104 USB to UART Bridge Controller
148094-[71756.358793] usb 2-3: Manufacturer: Silicon Labs
148145-[71756.358795] usb 2-3: SerialNumber: 00DB36EA
148192-[71756.359693] cp210x 2-3:1.0: cp210x converter detected
148249:[71756.360729] usb 2-3: cp210x converter now attached to ttyUSB0
```
  
  - Power ON the node if it is not already ON.
  
  - Connect to the port using screen - 
    `screen /dev/{name of the port found above} 115200`. In the above example, the device would be `/dev/ttyUSB0`.
   
  - You will be presented with a login prompt. If you have blank screen when connecting to a node that is ON, press the enter key to get a prompt. Sometimes the Odroid Consoles spit garbage, in that case, press `Cntr+C` a few times until you get a legible prompt.
  
  - Login into the NC using `root` username (or `waggle`) and `waggle` as the password. You whould be presented with a standard **bash shell**. 
  
  - Following the above steps, a console cable can also be connected to the EP to gain access. In addition to direct console, the EP can also be reached using SSH from the NC - 
 ```
 NC$/usr/lib/waggle/nodecontroller/scripts/eplogin
 ```
 ### Getting a RW / FS:
 
 The NC in the nodes have a **RO /** FS during regular operation. However, the NC can be put in a **RW /** FS operation mode for changing  configs and installing updates etc. During this process, the NC will operate in a reduced functionality (no RabbitMQ service, no plugins and no data sent to Beehive. Reverse tunnel, heartbeat and time-update services remain active) defined under the *waggle-core target* level. The NC can be put back in **RO /** FS which will enable the full operation mode set by *waggle-platform target* level.
 
 To put the Odroid in **RW /** FS: 
 ```
 NC$waggle-switch-to-safe-mode
 ```
 
 To put the NC in **RO /** FS: 
 
 ```
 NC$waggle-switch-to-operation-mode
 ```
 
Follow the same process above for setting the / of EP in RW and RO modes.  
 
## Edge-computing Remote Access

*TODO*



